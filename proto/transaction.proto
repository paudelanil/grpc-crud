syntax="proto3";

package grpc_crud;

option go_package = "grpc_crud/pb";


// Service for managing transactions.
service TransactionService {
    // Creates a new transaction.
    rpc Deposit(TransactionRequest) returns (TransactionResponse) ;

    // Withdraws an amount from an account.
    rpc WithDraw(TransactionRequest) returns (TransactionResponse);

    //Transfers money between two accounts.
    rpc TransferMoney(TransferMoneyRequest) returns (TransferMoneyResponse);

    // Generates a statement for an account within a date range.
    rpc GenerateStatement(GenerateStatementRequest) returns (GenerateStatementResponse);

    // Retrieves a specific statement by its ID.
    rpc GetStatement(GetStatementRequest) returns (GetStatementResponse);

    // Lists all statements for an account with pagination.
    rpc ListStatements(ListStatementsRequest) returns (ListStatementsResponse);

}

// ============================================

message DepositRequest {
    string account_id = 1;
    double amount = 2;
    string narration = 3;
    string reference_id = 4;
  
}

message DepositResponse {
    string journal_id = 1;
    string message = 2;
    double new_balance = 3;
}

message TransactionRequest {
    string account_id = 1;
    double amount = 2;
    string narration = 3;
    string reference_id = 4;
}


message TransactionResponse {
    string journal_id = 1;
    string message = 2;
    double new_balance = 3;
}


message TransferMoneyRequest {
    string from_account_id = 1;
    string to_account_id = 2;
    double amount = 3;
    string narration = 4;
    string reference_id = 5;
}

message TransferMoneyResponse {
    string journal_id = 1;
    string message = 2;
    double from_account_balance = 3;
    double to_account_balance = 4;
}

message GenerateStatementRequest {
    string account_id = 1;
    string start_date = 2;
    string end_date = 3;
}

message GenerateStatementResponse {
    string statement_id = 1;
    string account_id = 2;
    string start_date = 3;
    string end_date = 4;
    string opening_balance = 5;
    string closing_balance = 6;
    repeated  StatementTransaction transactions= 7;
    string generated_at = 8;
    
}

message GetStatementRequest {
    string statement_id = 1;
  
}

message GetStatementResponse {
    string statement_id = 1;
    string account_id = 2;
    string start_date = 3;
    string end_date = 4;
    repeated StatementTransaction transactions = 5;
}

message ListStatementsRequest {
    string account_id = 1;
    int32 page_number = 2;
    int32 page_size = 3;
}

message ListStatementsResponse {
    repeated GetStatementResponse statements = 1;
    int32 total_statements = 2;
}

message StatementTransaction {
    string transaction_id = 1;
    string date = 2;
    string description = 3;
    string entry_type = 4; // DEBIT or CREDIT
    double amount = 5;
    double balance = 6; // Running balance after this transaction
}

